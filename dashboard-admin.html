<!-- dashboard-admin.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Panel de Administración</title>
  <link rel="stylesheet" href="styles.css" />

  <style>
    /* ===== Reset pequeño para evitar desbordes ===== */
    * { box-sizing: border-box; }
    html, body { max-width: 100%; overflow-x: hidden; }

    /* ===== Encabezado con logo ===== */
    header{
      display:flex; justify-content:center; align-items:center;
      padding:16px 20px; background:#fff; border-bottom:1px solid #e5e7eb;
    }
    .logo{ max-width:200px; height:auto; }

    /* ===== Faja del título + botón a la derecha ===== */
    .hero-row{
      background:#fff; border-bottom:1px solid #e5e7eb; padding:18px 12px;
    }
    .hero-row-inner{
      max-width:1200px; margin:0 auto;
      display:grid; grid-template-columns:1fr auto 1fr; align-items:center;
      gap:12px; position:relative;
    }
    .hero-title{
      grid-column:2; margin:0; text-align:center; font-size:28px; font-weight:800;
    }
    .hero-action{
      grid-column:3; justify-self:end;
      border:none; border-radius:8px; padding:8px 12px;
      background:#e9ecef; color:#111; cursor:pointer; font-weight:600; font-size:14px;
      text-decoration:none;
    }

    /* ===== Contenedor principal ===== */
    .dashboard-container{ width:100%; margin:0; padding:0 16px; }

    /* ===== Barra de filtros (la crea tu JS) =====
       Evitamos desbordes dando ancho limitado y centrado.
       Nota: el JS añade estilos inline; esto NO interfiere con estas reglas. */
    #filtersBar{
      width:100%; max-width:1200px;
      margin-left:auto; margin-right:auto;
      padding-left:16px; padding-right:16px;
    }
    /* Inputs/Selects dentro del filtro: apariencia consistente */
    #filtersBar input, #filtersBar select{
      padding:8px 12px; border:1px solid #ccc; border-radius:4px;
      background:#f9f9f9; font-size:14px;
    }
    #filtersBar input:focus, #filtersBar select:focus{
      outline:none; border-color:#007bff; box-shadow:0 0 0 2px rgba(0,123,255,.2);
    }

    /* ===== Tarjetas de usuario (no se cambia estructura) ===== */
    .user-item{
      width:100%; margin:0 0 16px 0; padding:16px;
      background:#fff; border-radius:10px; border:2px solid #dfe3e8;
      box-shadow:0 2px 8px rgba(0,0,0,.06); position:relative; padding-top:16px;
    }
    .user-item > :not(.user-actions){ padding-right:200px; }

    .user-item button{
      margin:4px 8px 4px 0; padding:8px 12px;
      border:none; border-radius:4px; background:#007bff; color:#fff;
      cursor:pointer; white-space:nowrap; font-size:14px;
    }
    .user-item .delete-user-btn{ background:#dc3545; }
    .user-actions{
      position:absolute; top:6px; right:6px; display:flex; flex-direction:column; gap:0;
      align-items:flex-end; z-index:2;
    }
    .user-actions .inline-edit-cta{ display:flex; gap:6px; }
    .user-actions button{ background:#0d6efd; border-radius:6px; font-size:13px; padding:6px 6px; }
    .user-actions .delete-user-btn{ background:#dc3545; }

    .evals-container{ display:flex; flex-direction:column; max-height:260px; overflow-y:auto; margin:12px 0; padding:4px; border:1px solid #ddd; border-radius:6px; }
    .eval-option{ display:flex; align-items:center; gap:8px; padding:6px 8px; margin:6px 0; border-radius:4px; }
    .eval-item{ background:#f9f9f9; border:1px solid #e0e0e0; border-radius:6px; padding:12px 16px; margin:12px 0; }
    .eval-grid{ display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap:8px; }
    .eval-grid > div label{ font-size:12px; color:#444; display:block; margin-bottom:4px; }
    .muted{ color:#777; font-size:12px; }
    .hidden{ display:none !important; }
    .eval-title{ font-weight:600; margin:8px 0 4px; }

    /* ===== Botón “+ Usuario” flotante (como lo tenías) ===== */
    #createUserBtn{
      position:fixed; bottom:80px; right:20px; background:#28a745; color:#fff; border:none;
      padding:12px 16px; border-radius:50%; font-size:20px; cursor:pointer; z-index:1000;
    }

    /* ===== Cerrar sesión: SIEMPRE fijo, esquina inferior derecha, tamaño pequeño ===== */
    #logoutContainer{
      position:fixed !important; right:16px !important; bottom:16px !important; z-index:1100;
      pointer-events:auto;
    }
    #logoutButton{
      background:#dc3545; color:#fff; border:none; border-radius:8px;
      padding:8px 12px; font-weight:600; font-size:13px; cursor:pointer;
      box-shadow:0 6px 14px rgba(220,53,69,.28);
    }

    /* Modo oscuro (por si lo activas con tu toggle) */
    body.dark{ background:#121212; color:#eee; }
    body.dark .user-item{ background:#1e1e1e; box-shadow:0 2px 8px rgba(0,0,0,.5); }
    body.dark header{ background:#222; }

    @media (max-width:768px){
      .dashboard-container{ padding:0 10px; }
      .user-item > :not(.user-actions){ padding-right:0; }
    }
  </style>

  <!-- Firebase SDKs (v8 compat) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <!-- pdf-lib, fontkit, jsPDF -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script src="https://unpkg.com/@pdf-lib/fontkit/dist/fontkit.umd.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- Tu lógica -->
  <script src="dashboard-admin.js" defer></script>
</head>
<body>
  <!-- Logo -->
  <header>
    <a href="https://esys.cl/" target="_blank" rel="noopener">
      <img src="logo.png" alt="Logo de la Empresa" class="logo" />
    </a>
  </header>

  <!-- Título + botón a la derecha -->
  <section class="hero-row">
    <div class="hero-row-inner">
      <div></div>
      <h1 class="hero-title">Panel de Usuarios</h1>
      <a class="hero-action" href="dashboard-admin_evals.html">Panel de Cursos</a>
    </div>
  </section>

  <div class="dashboard-container">
    <!-- La barra de filtros (#filtersBar) la inyecta tu JS justo después del H1.
         Estas reglas CSS aseguran que no desborde ni provoque scroll horizontal. -->
    <div id="usersList">Cargando usuarios…</div>
  </div>

  <!-- Botón “+ Usuario” flotante -->
  <button id="createUserBtn">+</button>

  <!-- Formulario Crear Usuario (igual al tuyo) -->
  <div id="createUserForm"
       style="display:none; position:fixed; top:10vh; left:50%; transform:translateX(-50%); background:#fff;
              padding:24px; border:1px solid #ccc; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,.2); z-index:1001; width:360px;">
    <h3>Crear nuevo usuario</h3>
    <input id="newEmail"    type="email" placeholder="Email" style="width:100%;margin:8px 0;padding:8px;" />
    <input id="newPassword" type="text"   placeholder="Contraseña" value="123456" style="width:100%;margin:8px 0;padding:8px;" />
    <input id="newName"     type="text"   placeholder="Nombre"  style="width:100%;margin:8px 0;padding:8px;" />
    <input id="newRut"      type="text"   placeholder="RUT"     style="width:100%;margin:8px 0;padding:8px;" />
    <input id="newCustomId" type="text"   placeholder="CustomID" style="width:100%;margin:8px 0;padding:8px;" disabled />
    <input id="newCompany"  type="text"   placeholder="Empresa" style="width:100%;margin:8px 0;padding:8px;" />

    <label style="margin:8px 0 0; display:block;">Evaluaciones:</label>
    <div id="newEvalsContainer" class="evals-container"><!-- checkboxes + metas por evaluación --></div>

    <div style="text-align:right;margin-top:12px;">
      <button id="cancelCreateUser" style="margin-right:8px;">Cancelar</button>
      <button id="saveCreateUser"   style="background:#28a745;color:#fff;">Crear</button>
    </div>
  </div>

  <!-- Cerrar sesión fijo abajo a la derecha -->
  <div id="logoutContainer">
    <button id="logoutButton">Cerrar Sesión</button>
  </div>
</body>
</html>
